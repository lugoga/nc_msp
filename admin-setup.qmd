---
title: "Admin Setup - Supabase Configuration"
description: "View Supabase Cloud configuration for workshop registrations"
toc: false
---

::: {style="background-color: #d4edda; padding: 15px; border-radius: 8px; margin-bottom: 20px; border-left: 4px solid #28a745;"}
âœ… **Supabase is Already Configured** - All devices can now collect registrations without additional setup
:::

```{=html}
<div style="max-width: 900px; margin: 20px auto;">

<div id="statusDiv" style="display: block;">
  <div style="background-color: #e8f8f5; padding: 20px; border-radius: 8px; border-left: 4px solid #27ae60; margin-bottom: 20px;">
    <h2 style="margin-top: 0; color: #27ae60;">âœ“ Registration System Ready</h2>
    
    <p><strong>Status:</strong> <span style="color: #27ae60; font-weight: bold;">CONFIGURED & ACTIVE</span></p>
    
    <div style="background-color: white; padding: 15px; border-radius: 4px; margin: 15px 0; border: 1px solid #bbb;">
      <p><strong>Supabase Project URL:</strong></p>
      <code style="display: block; background-color: #f5f5f5; padding: 10px; border-radius: 4px; word-break: break-all;">https://nzobsdnyxouxfmiahgak.supabase.co</code>
      
      <p style="margin-top: 15px;"><strong>API Key:</strong></p>
      <code style="display: block; background-color: #f5f5f5; padding: 10px; border-radius: 4px; word-break: break-all;">sb_publishable_4IP9dT8nxXMI-1y--4VTJA_8zhY4NKZ</code>
    </div>
    
    <div style="background-color: #fff3cd; padding: 15px; border-radius: 4px; border-left: 4px solid #ff9800; margin: 15px 0;">
      <strong>â„¹ï¸ How It Works:</strong>
      <ul style="margin: 10px 0;">
        <li>All devices automatically load this configuration</li>
        <li>No setup needed on phones or tablets</li>
        <li>Registrations save directly to Supabase</li>
        <li>Data is backed up in the cloud</li>
      </ul>
    </div>
    
    <h3>What You Can Do Now:</h3>
    <ol>
      <li><strong>Share the Events Page:</strong> Give participants the link to <code>/events</code></li>
      <li><strong>View Registrations:</strong> Go to <a href="https://app.supabase.com" target="_blank">Supabase Dashboard</a> to see all submissions in real-time</li>
      <li><strong>Export Data:</strong> Click the menu (â‹®) next to the table name â†’ Export â†’ CSV</li>
    </ol>
  </div>

<div id="setupDiv" style="display: none;">
  <h2>Supabase Configuration</h2>
  
  <p>This page is for advanced configuration. The registration system is already set up.</p>
  
  <p>If you need to change the Supabase credentials, use the form below:</p>

  <div style="margin-bottom: 15px;">
    <label for="supabaseUrl" style="display: block; margin-bottom: 5px; font-weight: bold;">Supabase Project URL:</label>
    <input type="url" id="supabaseUrl" placeholder="https://your-project.supabase.co" style="width: 100%; padding: 10px; border: 1px solid #bbb; border-radius: 4px; box-sizing: border-box; font-family: monospace;">
  </div>

  <div style="margin-bottom: 20px;">
    <label for="supabaseKey" style="display: block; margin-bottom: 5px; font-weight: bold;">Supabase Anon Public Key:</label>
    <textarea id="supabaseKey" placeholder="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..." style="width: 100%; padding: 10px; border: 1px solid #bbb; border-radius: 4px; box-sizing: border-box; font-family: monospace; height: 80px;"></textarea>
  </div>

  <button id="saveConfigBtn" style="background-color: #27ae60; color: white; padding: 10px 20px; border: none; border-radius: 4px; cursor: pointer; font-size: 16px; font-weight: bold; margin-right: 10px;">
    âœ“ Save Configuration
  </button>
  
  <button id="testConfigBtn" style="background-color: #3498db; color: white; padding: 10px 20px; border: none; border-radius: 4px; cursor: pointer; font-size: 16px; font-weight: bold; margin-right: 10px;">
    ğŸ§ª Test Connection
  </button>

  <button id="resetConfigBtn" style="background-color: #e74c3c; color: white; padding: 10px 20px; border: none; border-radius: 4px; cursor: pointer; font-size: 16px; font-weight: bold;">
    ğŸ”„ Reset Configuration
  </button>


  <div id="statusMessage" style="margin-top: 20px; padding: 15px; border-radius: 4px; display: none;"></div>
</div>

<div id="statusDiv" style="margin-top: 30px; padding: 20px; border: 1px solid #ddd; border-radius: 8px; background-color: #f0f8ff; display: none;">
  <h3>âœ“ Supabase Connected!</h3>
  <p style="color: #666; font-size: 14px;">
    Your Supabase project is now connected and collecting registrations from all devices.
  </p>
  
  <div style="margin: 15px 0; padding: 15px; background-color: white; border: 1px solid #ddd; border-radius: 4px;">
    <p style="margin: 0;"><strong>View Registrations:</strong></p>
    <ul style="margin: 10px 0; padding-left: 20px;">
      <li><a href="#" id="supabaseLink" target="_blank" style="color: #3498db; text-decoration: none;">Open Supabase Dashboard â†’</a></li>
      <li>Go to "Table Editor" â†’ "msp_registrations"</li>
      <li>See all registrations in real-time from all devices</li>
    </ul>
  </div>

  <button id="resetConfigBtn" style="background-color: #e74c3c; color: white; padding: 8px 15px; border: none; border-radius: 4px; cursor: pointer; font-size: 14px;">
    ğŸ—‘ï¸ Reset Configuration
  </button>
</div>

</div>

<script>
// Load saved config from browser storage (try sessionStorage first, then localStorage)
async function loadConfig() {
  try {
    let url = sessionStorage.getItem('supabase_url');
    let key = sessionStorage.getItem('supabase_key');
    
    // Fallback to localStorage if sessionStorage is empty
    if (!url || !key) {
      url = localStorage.getItem('supabase_url');
      key = localStorage.getItem('supabase_key');
    }
    
    if (url && key) {
      document.getElementById('supabaseUrl').value = url;
      document.getElementById('supabaseKey').value = key;
      showStatus(url);
    }
  } catch (error) {
    console.log('No existing configuration found');
  }
}

// Save configuration
document.getElementById('saveConfigBtn').addEventListener('click', function() {
  const url = document.getElementById('supabaseUrl').value.trim();
  const key = document.getElementById('supabaseKey').value.trim();
  
  if (!url || !key) {
    showMessage('Please enter both URL and key', 'error');
    return;
  }
  
  if (!url.includes('supabase.co')) {
    showMessage('Invalid Supabase URL. Should include "supabase.co"', 'error');
    return;
  }
  
  // Show saving message
  showMessage('â³ Saving configuration...', 'info');
  
  // Save to BOTH sessionStorage and localStorage
  // - localStorage persists across browser sessions (permanent until cleared)
  // - sessionStorage provides backup for this session
  sessionStorage.setItem('supabase_url', url);
  sessionStorage.setItem('supabase_key', key);
  localStorage.setItem('supabase_url', url);
  localStorage.setItem('supabase_key', key);
  
  console.log('Supabase credentials saved to browser storage');
  
  // Test connection first
  testConnection(url, key).then(success => {
    if (success) {
      // If test passes, show success
      showMessage('âœ“ Configuration saved and verified! All devices can now register.', 'success');
      setTimeout(() => showStatus(url), 1500);
      
      // Log that admin configured it
      console.log('Supabase configured by admin at ' + new Date().toLocaleString());
    }
  });
});

// Test connection
async function testConnection(url, key) {
  try {
    const response = await fetch(`${url}/rest/v1/msp_registrations?limit=1`, {
      headers: {
        'apikey': key,
        'Authorization': `Bearer ${key}`
      }
    });
    
    if (response.ok) {
      showMessage('âœ“ Successfully connected to Supabase! All devices will now sync.', 'success');
      return true;
    } else if (response.status === 401) {
      showMessage('âœ— Invalid API key. Check your credentials.', 'error');
      return false;
    } else if (response.status === 404) {
      showMessage('âœ— Table not found. Did you create the table with SQL?', 'error');
      return false;
    } else {
      showMessage(`âœ— Connection failed: ${response.statusText}`, 'error');
      return false;
    }
  } catch (error) {
    showMessage(`âœ— Error: ${error.message}`, 'error');
    return false;
  }
}

// Test button
document.getElementById('testConfigBtn').addEventListener('click', function() {
  const url = document.getElementById('supabaseUrl').value.trim();
  const key = document.getElementById('supabaseKey').value.trim();
  
  if (!url || !key) {
    showMessage('Please enter URL and key first', 'error');
    return;
  }
  
  showMessage('ğŸ§ª Testing connection...', 'info');
  testConnection(url, key);
});

// Reset configuration
document.getElementById('resetConfigBtn')?.addEventListener('click', function() {
  if (confirm('Remove Supabase configuration? Registrations will only save locally on each device.')) {
    // Clear from both storages
    sessionStorage.removeItem('supabase_url');
    sessionStorage.removeItem('supabase_key');
    localStorage.removeItem('supabase_url');
    localStorage.removeItem('supabase_key');
    document.getElementById('supabaseUrl').value = '';
    document.getElementById('supabaseKey').value = '';
    showMessage('âœ“ Configuration reset.', 'success');
    document.getElementById('statusDiv').style.display = 'none';
    document.getElementById('setupDiv').style.display = 'block';
  }
});

// Show message
function showMessage(text, type) {
  const msgDiv = document.getElementById('statusMessage');
  msgDiv.textContent = text;
  
  if (type === 'success') {
    msgDiv.style.backgroundColor = '#d4edda';
    msgDiv.style.color = '#155724';
    msgDiv.style.borderLeft = '4px solid #28a745';
  } else if (type === 'error') {
    msgDiv.style.backgroundColor = '#f8d7da';
    msgDiv.style.color = '#721c24';
    msgDiv.style.borderLeft = '4px solid #dc3545';
  } else {
    msgDiv.style.backgroundColor = '#d1ecf1';
    msgDiv.style.color = '#0c5460';
    msgDiv.style.borderLeft = '4px solid #17a2b8';
  }
  
  msgDiv.style.display = 'block';
}

// Show status when configured
function showStatus(url) {
  document.getElementById('setupDiv').style.display = 'none';
  document.getElementById('statusDiv').style.display = 'block';
  
  // Update link
  const projectName = url.split('.')[0].replace('https://', '');
  document.getElementById('supabaseLink').href = `https://supabase.com/dashboard/project/${projectName}`;
}

// Copy SQL to clipboard
document.getElementById('copySqlBtn').addEventListener('click', function() {
  const sql = document.querySelector('textarea[readonly]').value;
  navigator.clipboard.writeText(sql).then(() => {
    this.textContent = 'âœ“ Copied!';
    setTimeout(() => {
      this.textContent = 'ğŸ“‹ Copy SQL to Clipboard';
    }, 2000);
  });
});

// Load on page load
window.addEventListener('load', loadConfig);
</script>
```

---

## Features

- **Real-time Updates:** See registrations appear instantly
- **Automatic Backup:** All data backed up in Supabase cloud
- **Free Tier:** 500 MB storage, plenty for thousands of registrations
- **Secure:** Only accepts registrations through proper API
- **Accessible:** Log in from anywhere to view data
- **Easy Export:** Download data as CSV from Supabase dashboard

---

## Next Steps

1. Complete setup above
2. Visit `/events` and test registration
3. Check your Supabase dashboard to see the data
4. Share `/events` link with participants

