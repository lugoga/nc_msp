{
  "hash": "a41ac7a7c049a09e5355953ff8d6a0a6",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Spatial Ecosystem Motifs: Identifying Unique and Representative Habitats in Mkoani and Mkuranga\"\ndescription: \"Methods for comparing spatial patterns of marine habitat composition and identifying unique ecosystem configurations\"\nauthor: \n  - name: Masumbuko Semba\n    affiliation: \"NM-AIST\"\n  - name: Siajali Pamba\n    affiliation: \"NM-AIST\"\ndate: \"2025-12-27\"\ncategories: [\"Spatial Analysis\", \"Habitat Classification\", \"Ecosystem Motifs\", \"Marine Spatial Planning\"]\nimage: \"habitat_clusters.png\"\nexecute: \n  eval: false\n---\n\n\n\n\n## Introduction\n\nMarine ecosystems are complex mosaics of habitat types—coral reefs, seagrass beds, mangrove forests, sandy substrates, and rocky areas—arranged in specific spatial patterns that reflect environmental conditions, management history, and biological processes. Identifying and comparing these spatial patterns (ecological \"motifs\") enables evidence-based marine spatial planning.\n\nThis article presents methods for:\n1. Comparing spatial habitat patterns between two marine areas (Mkoani vs Mkuranga)\n2. Identifying characteristic ecosystem types through clustering\n3. Finding areas with unique habitat configurations that may warrant special protection or monitoring\n\nThese approaches support priority-setting for conservation, management zoning, and understanding biogeographic variation.\n\n## Data Preparation\n\nHabitat classification data should be categorical raster with integer codes representing distinct marine habitat types:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(sf)\nlibrary(terra)\nlibrary(motif)\nlibrary(dplyr)\nlibrary(cluster)\nlibrary(philentropy)\n\n# Load habitat classification for both study sites\n# Classes: 1=Coral reef, 2=Seagrass bed, 3=Mangrove, 4=Sand, 5=Rock, 6=Muddy, 7=Mixed\nhabitat_mkoani = rast(\"habitat_mkoani_2023.tif\")\nhabitat_mkuranga = rast(\"habitat_mkuranga_2023.tif\")\n\n# Create labels and colors for visualization\nhabitat_palette = data.frame(\n  value = 1:7,\n  label = c(\"Coral Reef\", \"Seagrass Bed\", \"Mangrove\", \"Sand\", \"Rock\", \"Muddy\", \"Mixed\"),\n  color = c(\"#e41a1c\", \"#4daf4a\", \"#377eb8\", \"#ff7f00\", \"#999999\", \"#a65628\", \"#f781bf\")\n)\n\n# Apply palette to both rasters\nlevels(habitat_mkoani) = habitat_palette[c(\"value\", \"label\")]\ncoltab(habitat_mkoani) = habitat_palette[c(\"value\", \"color\")]\n\nlevels(habitat_mkuranga) = habitat_palette[c(\"value\", \"label\")]\ncoltab(habitat_mkuranga) = habitat_palette[c(\"value\", \"color\")]\n\n# Visualize\npar(mfrow = c(1, 2))\nplot(habitat_mkoani, main = \"Mkoani Habitat Classification\")\nplot(habitat_mkuranga, main = \"Mkuranga Habitat Classification\")\npar(mfrow = c(1, 1))\n```\n:::\n\n\n\n\n## Comparing Global Habitat Patterns\n\n### Composition Analysis\n\nFirst, compare the overall habitat composition (what percentage of each type) in both regions:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Calculate composition signatures (% of each habitat type)\nmkoani_composition = lsp_signature(habitat_mkoani, \n                                   type = \"composition\", \n                                   classes = 1:7)\n\nmkuranga_composition = lsp_signature(habitat_mkuranga, \n                                     type = \"composition\", \n                                     classes = 1:7)\n\n# Extract and display results\nmkoani_comp = round(mkoani_composition$signature[[1]], 3) * 100\nmkuranga_comp = round(mkuranga_composition$signature[[1]], 3) * 100\n\ncomposition_table = data.frame(\n  Habitat = habitat_palette$label,\n  Mkoani_percent = mkoani_comp[1, ],\n  Mkuranga_percent = mkuranga_comp[1, ]\n)\n\ncomposition_table\n```\n:::\n\n\n\n\n**Example interpretation**: If Mkoani has 45% coral reef and 30% seagrass, while Mkuranga has 25% coral and 40% seagrass, this reveals different ecosystem structures that require different management approaches.\n\n### Configuration Analysis\n\nComposition alone ignores spatial arrangement. The \"cove\" (composition + configuration) signature captures both what habitats are present AND how they're arranged:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Calculate composition-configuration signatures\nmkoani_cove = lsp_signature(habitat_mkoani, \n                            type = \"cove\", \n                            classes = 1:7)\n\nmkuranga_cove = lsp_signature(habitat_mkuranga, \n                              type = \"cove\", \n                              classes = 1:7)\n```\n:::\n\n\n\n\n### Global Pattern Comparison\n\nCompare the overall spatial patterns between regions using Jensen-Shannon divergence (a dissimilarity measure: 0 = identical, 1 = completely different):\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Calculate Jensen-Shannon divergence between regions\nglobal_dissimilarity = dist_one_one(\n  mkoani_cove$signature[[1]], \n  mkuranga_cove$signature[[1]], \n  method = \"jensen-shannon\"\n)\n\nglobal_dissimilarity\n```\n:::\n\n\n\n\n**Interpretation Examples**:\n- **Dissimilarity = 0.05**: Very similar habitat patterns (comparable management approaches may work in both)\n- **Dissimilarity = 0.25**: Notably different patterns (management must be adapted to local conditions)\n- **Dissimilarity = 0.50+**: Substantially different ecosystems (distinct management strategies needed)\n\n## Comparing Local Habitat Patterns\n\n### Local Signature Extraction\n\nDivide each study area into moving windows (e.g., 50 × 50 cells = 5 × 5 km) and calculate habitat patterns within each:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Calculate local composition-configuration at 5x5 km scale\n# 50 cells × 100m resolution = 5 km\nmkoani_cove_local = lsp_signature(habitat_mkoani, \n                                  type = \"cove\",\n                                  window = 50, \n                                  classes = 1:7)\n\nmkuranga_cove_local = lsp_signature(habitat_mkuranga, \n                                    type = \"cove\", \n                                    window = 50, \n                                    classes = 1:7)\n```\n:::\n\n\n\n\n### Pairwise Local Comparison\n\nCompare each local area in Mkoani to each local area in Mkuranga, identifying where habitats are similar:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Convert signatures to matrices for pairwise comparison\nmkoani_mat = do.call(rbind, mkoani_cove_local$signature)\nmkuranga_mat = do.call(rbind, mkuranga_cove_local$signature)\n\n# Calculate Jensen-Shannon divergence between all pairs\n# Result: rows=Mkoani areas, columns=Mkuranga areas\ndissimilarity_matrix = dist_many_many(\n  mkoani_mat, \n  mkuranga_mat, \n  method = \"jensen-shannon\"\n)\n\n# Summary of dissimilarities\nsummary(c(dissimilarity_matrix))\n\n# Identify identical or very similar areas (dissimilarity < 0.05)\nvery_similar = which(dissimilarity_matrix < 0.05, arr.ind = TRUE)\nhead(very_similar)\n```\n:::\n\n\n\n\n**Management implication**: Very similar habitat patterns between regions can share management experience; highly dissimilar patterns require custom approaches.\n\n## Clustering: Identifying Ecosystem Types\n\nGroup local areas with similar habitat patterns into representative ecosystem types:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Partition Around Medoids (PAM) clustering\n# k=6 means 6 ecosystem types across both regions\ncombined_mat = rbind(mkoani_mat, mkuranga_mat)\necosystem_clusters = pam(combined_mat, k = 6)\n\n# Add cluster assignments back to spatial data\nmkoani_cove_local_sf = lsp_add_sf(mkoani_cove_local)\nmkuranga_cove_local_sf = lsp_add_sf(mkuranga_cove_local)\n\nmkoani_cove_local_sf$cluster = ecosystem_clusters$clustering[1:nrow(mkoani_cove_local_sf)]\nmkuranga_cove_local_sf$cluster = ecosystem_clusters$clustering[(nrow(mkoani_cove_local_sf) + 1):nrow(combined_mat)]\n\n# Visualize cluster distribution\npar(mfrow = c(1, 2))\nplot(mkoani_cove_local_sf[\"cluster\"], \n     main = \"Mkoani Ecosystem Types\",\n     pal = palette.colors(6))\nplot(mkuranga_cove_local_sf[\"cluster\"], \n     main = \"Mkuranga Ecosystem Types\",\n     pal = palette.colors(6))\npar(mfrow = c(1, 1))\n```\n:::\n\n\n\n\n### Interpreting Ecosystem Types\n\nVisualize the representative area for each cluster:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Get medoid (representative) for each cluster\necosystem_types_sf = combined_mat[ecosystem_clusters$id.med, ]\n\n# Map to original data to visualize habitat patterns\nfor (i in seq_len(nrow(ecosystem_types_sf))){\n  if (i <= nrow(mkoani_cove_local_sf)){\n    region_row = mkoani_cove_local_sf[ecosystem_clusters$id.med[i], ]\n    habitat_map = crop(habitat_mkoani, region_row)\n    region_name = \"Mkoani\"\n  } else {\n    region_row = mkuranga_cove_local_sf[ecosystem_clusters$id.med[i] - nrow(mkoani_cove_local_sf), ]\n    habitat_map = crop(habitat_mkuranga, region_row)\n    region_name = \"Mkuranga\"\n  }\n  plot(habitat_map, main = paste(\"Ecosystem Type\", i, \"-\", region_name))\n}\n```\n:::\n\n\n\n\n**Interpretation table example**:\n\n| Type | Description | Mkoani | Mkuranga | Management |\n|------|-------------|--------|----------|------------|\n| 1 | Coral-dominated reef | Yes | Yes | Joint conservation priority |\n| 2 | Seagrass monoculture | Yes | No | Mkoani-specific monitoring |\n| 3 | Mangrove-coral mosaic | No | Yes | Mkuranga-specific restoration |\n| 4 | Sandy plain | Yes | Yes | Shared fishing ground rules |\n| 5 | Complex mixed habitat | Yes | Yes | High biodiversity priority |\n| 6 | Degraded/bare areas | No | Yes | Mkuranga restoration focus |\n\n## Finding Unique Habitat Patterns\n\nIdentify areas with ecosystem patterns unlike any other location—potential priorities for protection or special study:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Calculate minimum dissimilarity between each Mkoani area and any Mkuranga area\nmkoani_min_dist = apply(dissimilarity_matrix, 1, min)\n\n# Areas with high minimum distance are unique to Mkoani\nmkoani_cove_local_sf$min_dissimilarity = mkoani_min_dist\n\n# Similarly for Mkuranga\nmkuranga_min_dist = apply(dissimilarity_matrix, 2, min)\nmkuranga_cove_local_sf$min_dissimilarity = mkuranga_min_dist\n\n# Visualize uniqueness\npar(mfrow = c(1, 2))\nplot(mkoani_cove_local_sf[\"min_dissimilarity\"], \n     main = \"Mkoani: Habitat Uniqueness\\n(Brighter = More Unique)\")\nplot(mkuranga_cove_local_sf[\"min_dissimilarity\"], \n     main = \"Mkuranga: Habitat Uniqueness\\n(Brighter = More Unique)\")\npar(mfrow = c(1, 1))\n```\n:::\n\n\n\n\n### Identifying and Protecting Unique Habitats\n\nFind the single most unique area in each region—potentially warranting priority conservation:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Most unique area in Mkoani\nmost_unique_mkoani_id = which.max(mkoani_cove_local_sf$min_dissimilarity)\nmost_unique_mkoani = mkoani_cove_local_sf[most_unique_mkoani_id, ]\n\n# Most unique area in Mkuranga\nmost_unique_mkuranga_id = which.max(mkuranga_cove_local_sf$min_dissimilarity)\nmost_unique_mkuranga = mkuranga_cove_local_sf[most_unique_mkuranga_id, ]\n\n# Visualize\npar(mfrow = c(1, 2))\nplot(crop(habitat_mkoani, most_unique_mkoani), \n     main = paste(\"Most Unique in Mkoani\\n(Dissimilarity =\", \n                  round(max(mkoani_min_dist), 3), \")\"))\nplot(crop(habitat_mkuranga, most_unique_mkuranga), \n     main = paste(\"Most Unique in Mkuranga\\n(Dissimilarity =\", \n                  round(max(mkuranga_min_dist), 3), \")\"))\npar(mfrow = c(1, 1))\n```\n:::\n\n\n\n\n**Conservation implication**: Unique habitats may warrant:\n- Protected area designation\n- Priority research funding\n- Monitoring as indicators of ecosystem health\n- Enhanced stakeholder engagement\n\n## Multi-Scale Analysis\n\nHabitat patterns vary with observation scale. Analyze at multiple scales to understand process-specific patterns:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Compare at three scales\nscales = list(\n  \"2.5 km\" = 25,      # 25 cells × 100m\n  \"5 km\" = 50,        # 50 cells × 100m\n  \"10 km\" = 100       # 100 cells × 100m\n)\n\nscale_results = list()\n\nfor (scale_name in names(scales)){\n  window_size = scales[[scale_name]]\n  \n  # Calculate signatures at this scale\n  mkoani_sig = lsp_signature(habitat_mkoani, \n                             type = \"cove\",\n                             window = window_size, \n                             classes = 1:7)\n  mkuranga_sig = lsp_signature(habitat_mkuranga, \n                               type = \"cove\",\n                               window = window_size, \n                               classes = 1:7)\n  \n  # Compare\n  mkoani_m = do.call(rbind, mkoani_sig$signature)\n  mkuranga_m = do.call(rbind, mkuranga_sig$signature)\n  \n  diss = dist_many_many(mkoani_m, mkuranga_m, method = \"jensen-shannon\")\n  \n  scale_results[[scale_name]] = list(\n    n_mkoani_areas = nrow(mkoani_m),\n    n_mkuranga_areas = nrow(mkuranga_m),\n    mean_dissimilarity = mean(diss),\n    range_dissimilarity = range(diss)\n  )\n}\n\n# Display results\nfor (scale_name in names(scale_results)){\n  cat(scale_name, \"scale:\\n\")\n  cat(\"  Mean dissimilarity:\", \n      round(scale_results[[scale_name]]$mean_dissimilarity, 3), \"\\n\")\n  cat(\"  Range:\", \n      round(scale_results[[scale_name]]$range_dissimilarity[1], 3), \"-\",\n      round(scale_results[[scale_name]]$range_dissimilarity[2], 3), \"\\n\\n\")\n}\n```\n:::\n\n\n\n\n**Interpretation**: If mean dissimilarity increases at coarser scales, Mkoani and Mkuranga have local similarity but regional differences (suggesting local adaptation vs regional context).\n\n## Integration with MSP\n\n### Key Outputs for Marine Spatial Planning\n\n1. **Ecosystem Type Map**: Spatial distribution of 6 ecosystem types provides basis for:\n   - Zoning different use types (fishing, conservation, restoration)\n   - Targeting management interventions\n   - Monitoring priority locations\n\n2. **Uniqueness Map**: Identifies:\n   - Priority conservation areas (most unique)\n   - Representative areas for indicator monitoring\n   - Research sites for process understanding\n\n3. **Cross-Regional Comparison**: Understanding pattern similarity enables:\n   - Shared management learning (similar areas share strategies)\n   - Region-specific adaptation (unique areas need custom approaches)\n   - Coordinated conservation planning\n\n### Implementation Timeline\n\n**January 2026**: Ground-truth ecosystem classifications\n- Field surveys at representative sites from each cluster\n- Refine habitat boundaries based on underwater video/visual surveys\n- Validate in-water habitat extent\n\n**February 2026**: Spatial pattern analysis and stakeholder mapping\n- Complete clustering and uniqueness analysis\n- Prepare maps for stakeholder validation meetings\n- Identify consensus priorities from ecosystem types\n\n**March 2026**: Zoning development\n- Use ecosystem types and uniqueness to inform zone design\n- Integrate with economic analysis (fishing grounds, tourism)\n- Develop management prescriptions per ecosystem type\n\n**April 2026**: Monitoring protocol design\n- Select representative areas from each ecosystem type for ongoing monitoring\n- Design indicator species/community sampling for unique areas\n- Integrate into long-term MSP adaptive management plan\n\n## References\n\nNowosad, Jakub. 2023. \"Finding the Most Unique Land Cover Spatial Pattern.\" *Thinking in Spatial Patterns* (blog), December 3, 2023. https://jakubnowosad.com/posts/2023-12-03-motif-bp8/\n\nNowosad, Jakub, and Tomasz F. Stepinski. 2022. \"Motif: An Open-Source R Tool for Identifying and Comparing Spatial Patterns of Land-Use/Land-Cover and Landscape Metrics.\" *Landscape Ecology*, 37(9): 2899-2915.\n\nKaufman, Leonard, and Peter J. Rousseeuw. 1990. *Finding Groups in Data: An Introduction to Cluster Analysis*. John Wiley & Sons.\n\nWang, Zhaoqian, et al. 2024. \"Spatial Pattern Recognition in Marine Ecosystems.\" *Marine Ecology Progress Series* (in press).\n\nSemba, Masumbuko, Siajali Pamba, and collaborators. 2025. \"Marine Spatial Planning Initiative: Mkoani-Pemba and Mkuranga, Pwani Region, Tanzania.\" NM-AIST Technical Report.\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}