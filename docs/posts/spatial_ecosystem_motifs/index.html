<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.39">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Masumbuko Semba">
<meta name="author" content="Siajali Pamba">
<meta name="dcterms.date" content="2025-12-27">
<meta name="description" content="Methods for comparing spatial patterns of marine habitat composition and identifying unique ecosystem configurations">

<title>Spatial Ecosystem Motifs: Identifying Unique and Representative Habitats in Mkoani and Mkuranga</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-e26003cea8cd680ca0c55a263523d882.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-20cb7ac89268f2f6837cd43da0a0d99f.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<meta name="description" content="Marine Spatial Planning Initiative for Tanzania - Spatial analysis, coastal management, and ecosystem monitoring in Mkoani and Mkuranga districts">
<meta name="keywords" content="marine spatial planning, coastal management, Tanzania, land cover analysis, ecosystem monitoring, Mkoani, Mkuranga, Pemba, Pwani">
<meta name="author" content="Masumbuko Semba, SOAF-UDSM">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta property="og:title" content="Spatial Ecosystem Motifs: Identifying Unique and Representative Habitats in Mkoani and Mkuranga">
<meta property="og:description" content="Methods for comparing spatial patterns of marine habitat composition and identifying unique ecosystem configurations">
<meta property="og:type" content="website">
<meta property="og:url" content="https://lugoga.github.io/nc_msp/">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="Spatial Ecosystem Motifs: Identifying Unique and Representative Habitats in Mkoani and Mkuranga">
<meta name="twitter:description" content="Methods for comparing spatial patterns of marine habitat composition and identifying unique ecosystem configurations">


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../images/coat_OG_web.png" alt="" class="navbar-logo">
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="../../about.html" aria-current="page"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../schedule.html"> 
<span class="menu-text">Scope</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../blog.html"> 
<span class="menu-text">Posts</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-reports" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Reports</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-reports">    
        <li>
    <a class="dropdown-item" href="../../reports/UN_Inception report_14092025_SM.pdf" target="_blank">
 <span class="dropdown-text">Deliverable One: Inception Report</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-resources" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Resources</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-resources">    
        <li>
    <a class="dropdown-item" href="../../TOR_259658.pdf" target="_blank">
 <span class="dropdown-text">Resources1: TOR</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <span class="nav-link">
<span class="menu-text">WebApp</span>
    </span>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../team.html"> 
<span class="menu-text">Team</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../gallery.html"> 
<span class="menu-text">Gallery</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/lugoga/stock_training_somalia"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Spatial Ecosystem Motifs: Identifying Unique and Representative Habitats in Mkoani and Mkuranga</li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Project Info</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../about.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">About This Marine Spatial Planning Initiative</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../team.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Meet Our Team</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../news.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">News &amp; Updates</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Weather Updates</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../weather.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Live Weather</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../news.html#current-conditions--field-operations" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Seasonal Calendar</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="https://www.ncei.noaa.gov/products/ocean-weather-forecast" class="sidebar-item-text sidebar-link" target="_blank">
 <span class="menu-text">NOAA Marine Forecast</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="https://oceancurrents.rsmas.miami.edu/" class="sidebar-item-text sidebar-link" target="_blank">
 <span class="menu-text">Ocean Current Maps</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="https://www.tides.noaa.gov/" class="sidebar-item-text sidebar-link" target="_blank">
 <span class="menu-text">Sea Level Information</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="https://www.nhc.noaa.gov/" class="sidebar-item-text sidebar-link" target="_blank">
 <span class="menu-text">Tropical Storm Tracking</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#data-preparation" id="toc-data-preparation" class="nav-link" data-scroll-target="#data-preparation">Data Preparation</a></li>
  <li><a href="#comparing-global-habitat-patterns" id="toc-comparing-global-habitat-patterns" class="nav-link" data-scroll-target="#comparing-global-habitat-patterns">Comparing Global Habitat Patterns</a>
  <ul class="collapse">
  <li><a href="#composition-analysis" id="toc-composition-analysis" class="nav-link" data-scroll-target="#composition-analysis">Composition Analysis</a></li>
  <li><a href="#configuration-analysis" id="toc-configuration-analysis" class="nav-link" data-scroll-target="#configuration-analysis">Configuration Analysis</a></li>
  <li><a href="#global-pattern-comparison" id="toc-global-pattern-comparison" class="nav-link" data-scroll-target="#global-pattern-comparison">Global Pattern Comparison</a></li>
  </ul></li>
  <li><a href="#comparing-local-habitat-patterns" id="toc-comparing-local-habitat-patterns" class="nav-link" data-scroll-target="#comparing-local-habitat-patterns">Comparing Local Habitat Patterns</a>
  <ul class="collapse">
  <li><a href="#local-signature-extraction" id="toc-local-signature-extraction" class="nav-link" data-scroll-target="#local-signature-extraction">Local Signature Extraction</a></li>
  <li><a href="#pairwise-local-comparison" id="toc-pairwise-local-comparison" class="nav-link" data-scroll-target="#pairwise-local-comparison">Pairwise Local Comparison</a></li>
  </ul></li>
  <li><a href="#clustering-identifying-ecosystem-types" id="toc-clustering-identifying-ecosystem-types" class="nav-link" data-scroll-target="#clustering-identifying-ecosystem-types">Clustering: Identifying Ecosystem Types</a>
  <ul class="collapse">
  <li><a href="#interpreting-ecosystem-types" id="toc-interpreting-ecosystem-types" class="nav-link" data-scroll-target="#interpreting-ecosystem-types">Interpreting Ecosystem Types</a></li>
  </ul></li>
  <li><a href="#finding-unique-habitat-patterns" id="toc-finding-unique-habitat-patterns" class="nav-link" data-scroll-target="#finding-unique-habitat-patterns">Finding Unique Habitat Patterns</a>
  <ul class="collapse">
  <li><a href="#identifying-and-protecting-unique-habitats" id="toc-identifying-and-protecting-unique-habitats" class="nav-link" data-scroll-target="#identifying-and-protecting-unique-habitats">Identifying and Protecting Unique Habitats</a></li>
  </ul></li>
  <li><a href="#multi-scale-analysis" id="toc-multi-scale-analysis" class="nav-link" data-scroll-target="#multi-scale-analysis">Multi-Scale Analysis</a></li>
  <li><a href="#integration-with-msp" id="toc-integration-with-msp" class="nav-link" data-scroll-target="#integration-with-msp">Integration with MSP</a>
  <ul class="collapse">
  <li><a href="#key-outputs-for-marine-spatial-planning" id="toc-key-outputs-for-marine-spatial-planning" class="nav-link" data-scroll-target="#key-outputs-for-marine-spatial-planning">Key Outputs for Marine Spatial Planning</a></li>
  <li><a href="#implementation-timeline" id="toc-implementation-timeline" class="nav-link" data-scroll-target="#implementation-timeline">Implementation Timeline</a></li>
  </ul></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Spatial Ecosystem Motifs: Identifying Unique and Representative Habitats in Mkoani and Mkuranga</h1>
  <div class="quarto-categories">
    <div class="quarto-category">Spatial Analysis</div>
    <div class="quarto-category">Habitat Classification</div>
    <div class="quarto-category">Ecosystem Motifs</div>
    <div class="quarto-category">Marine Spatial Planning</div>
  </div>
  </div>

<div>
  <div class="description">
    Methods for comparing spatial patterns of marine habitat composition and identifying unique ecosystem configurations
  </div>
</div>

<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Authors</div>
  <div class="quarto-title-meta-heading">Affiliation</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author">Masumbuko Semba </p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            NM-AIST
          </p>
      </div>
    <div class="quarto-title-meta-contents">
    <p class="author">Siajali Pamba </p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            NM-AIST
          </p>
      </div>
  </div>

<div class="quarto-title-meta">

      
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">December 27, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>Marine ecosystems are complex mosaics of habitat types—coral reefs, seagrass beds, mangrove forests, sandy substrates, and rocky areas—arranged in specific spatial patterns that reflect environmental conditions, management history, and biological processes. Identifying and comparing these spatial patterns (ecological “motifs”) enables evidence-based marine spatial planning.</p>
<p>This article presents methods for: 1. Comparing spatial habitat patterns between two marine areas (Mkoani vs Mkuranga) 2. Identifying characteristic ecosystem types through clustering 3. Finding areas with unique habitat configurations that may warrant special protection or monitoring</p>
<p>These approaches support priority-setting for conservation, management zoning, and understanding biogeographic variation.</p>
</section>
<section id="data-preparation" class="level2">
<h2 class="anchored" data-anchor-id="data-preparation">Data Preparation</h2>
<p>Habitat classification data should be categorical raster with integer codes representing distinct marine habitat types:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(terra)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(motif)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cluster)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(philentropy)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Load habitat classification for both study sites</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Classes: 1=Coral reef, 2=Seagrass bed, 3=Mangrove, 4=Sand, 5=Rock, 6=Muddy, 7=Mixed</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>habitat_mkoani <span class="ot">=</span> <span class="fu">rast</span>(<span class="st">"habitat_mkoani_2023.tif"</span>)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>habitat_mkuranga <span class="ot">=</span> <span class="fu">rast</span>(<span class="st">"habitat_mkuranga_2023.tif"</span>)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Create labels and colors for visualization</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>habitat_palette <span class="ot">=</span> <span class="fu">data.frame</span>(</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">value =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>,</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">label =</span> <span class="fu">c</span>(<span class="st">"Coral Reef"</span>, <span class="st">"Seagrass Bed"</span>, <span class="st">"Mangrove"</span>, <span class="st">"Sand"</span>, <span class="st">"Rock"</span>, <span class="st">"Muddy"</span>, <span class="st">"Mixed"</span>),</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">color =</span> <span class="fu">c</span>(<span class="st">"#e41a1c"</span>, <span class="st">"#4daf4a"</span>, <span class="st">"#377eb8"</span>, <span class="st">"#ff7f00"</span>, <span class="st">"#999999"</span>, <span class="st">"#a65628"</span>, <span class="st">"#f781bf"</span>)</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply palette to both rasters</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(habitat_mkoani) <span class="ot">=</span> habitat_palette[<span class="fu">c</span>(<span class="st">"value"</span>, <span class="st">"label"</span>)]</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="fu">coltab</span>(habitat_mkoani) <span class="ot">=</span> habitat_palette[<span class="fu">c</span>(<span class="st">"value"</span>, <span class="st">"color"</span>)]</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(habitat_mkuranga) <span class="ot">=</span> habitat_palette[<span class="fu">c</span>(<span class="st">"value"</span>, <span class="st">"label"</span>)]</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="fu">coltab</span>(habitat_mkuranga) <span class="ot">=</span> habitat_palette[<span class="fu">c</span>(<span class="st">"value"</span>, <span class="st">"color"</span>)]</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(habitat_mkoani, <span class="at">main =</span> <span class="st">"Mkoani Habitat Classification"</span>)</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(habitat_mkuranga, <span class="at">main =</span> <span class="st">"Mkuranga Habitat Classification"</span>)</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="comparing-global-habitat-patterns" class="level2">
<h2 class="anchored" data-anchor-id="comparing-global-habitat-patterns">Comparing Global Habitat Patterns</h2>
<section id="composition-analysis" class="level3">
<h3 class="anchored" data-anchor-id="composition-analysis">Composition Analysis</h3>
<p>First, compare the overall habitat composition (what percentage of each type) in both regions:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate composition signatures (% of each habitat type)</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>mkoani_composition <span class="ot">=</span> <span class="fu">lsp_signature</span>(habitat_mkoani, </span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">type =</span> <span class="st">"composition"</span>, </span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">classes =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>mkuranga_composition <span class="ot">=</span> <span class="fu">lsp_signature</span>(habitat_mkuranga, </span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">type =</span> <span class="st">"composition"</span>, </span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">classes =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract and display results</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>mkoani_comp <span class="ot">=</span> <span class="fu">round</span>(mkoani_composition<span class="sc">$</span>signature[[<span class="dv">1</span>]], <span class="dv">3</span>) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>mkuranga_comp <span class="ot">=</span> <span class="fu">round</span>(mkuranga_composition<span class="sc">$</span>signature[[<span class="dv">1</span>]], <span class="dv">3</span>) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>composition_table <span class="ot">=</span> <span class="fu">data.frame</span>(</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">Habitat =</span> habitat_palette<span class="sc">$</span>label,</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">Mkoani_percent =</span> mkoani_comp[<span class="dv">1</span>, ],</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">Mkuranga_percent =</span> mkuranga_comp[<span class="dv">1</span>, ]</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>composition_table</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><strong>Example interpretation</strong>: If Mkoani has 45% coral reef and 30% seagrass, while Mkuranga has 25% coral and 40% seagrass, this reveals different ecosystem structures that require different management approaches.</p>
</section>
<section id="configuration-analysis" class="level3">
<h3 class="anchored" data-anchor-id="configuration-analysis">Configuration Analysis</h3>
<p>Composition alone ignores spatial arrangement. The “cove” (composition + configuration) signature captures both what habitats are present AND how they’re arranged:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate composition-configuration signatures</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>mkoani_cove <span class="ot">=</span> <span class="fu">lsp_signature</span>(habitat_mkoani, </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>                            <span class="at">type =</span> <span class="st">"cove"</span>, </span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>                            <span class="at">classes =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>mkuranga_cove <span class="ot">=</span> <span class="fu">lsp_signature</span>(habitat_mkuranga, </span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>                              <span class="at">type =</span> <span class="st">"cove"</span>, </span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>                              <span class="at">classes =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="global-pattern-comparison" class="level3">
<h3 class="anchored" data-anchor-id="global-pattern-comparison">Global Pattern Comparison</h3>
<p>Compare the overall spatial patterns between regions using Jensen-Shannon divergence (a dissimilarity measure: 0 = identical, 1 = completely different):</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate Jensen-Shannon divergence between regions</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>global_dissimilarity <span class="ot">=</span> <span class="fu">dist_one_one</span>(</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  mkoani_cove<span class="sc">$</span>signature[[<span class="dv">1</span>]], </span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  mkuranga_cove<span class="sc">$</span>signature[[<span class="dv">1</span>]], </span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"jensen-shannon"</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>global_dissimilarity</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><strong>Interpretation Examples</strong>: - <strong>Dissimilarity = 0.05</strong>: Very similar habitat patterns (comparable management approaches may work in both) - <strong>Dissimilarity = 0.25</strong>: Notably different patterns (management must be adapted to local conditions) - <strong>Dissimilarity = 0.50+</strong>: Substantially different ecosystems (distinct management strategies needed)</p>
</section>
</section>
<section id="comparing-local-habitat-patterns" class="level2">
<h2 class="anchored" data-anchor-id="comparing-local-habitat-patterns">Comparing Local Habitat Patterns</h2>
<section id="local-signature-extraction" class="level3">
<h3 class="anchored" data-anchor-id="local-signature-extraction">Local Signature Extraction</h3>
<p>Divide each study area into moving windows (e.g., 50 × 50 cells = 5 × 5 km) and calculate habitat patterns within each:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate local composition-configuration at 5x5 km scale</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 50 cells × 100m resolution = 5 km</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>mkoani_cove_local <span class="ot">=</span> <span class="fu">lsp_signature</span>(habitat_mkoani, </span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">type =</span> <span class="st">"cove"</span>,</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">window =</span> <span class="dv">50</span>, </span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">classes =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>mkuranga_cove_local <span class="ot">=</span> <span class="fu">lsp_signature</span>(habitat_mkuranga, </span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">type =</span> <span class="st">"cove"</span>, </span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">window =</span> <span class="dv">50</span>, </span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">classes =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="pairwise-local-comparison" class="level3">
<h3 class="anchored" data-anchor-id="pairwise-local-comparison">Pairwise Local Comparison</h3>
<p>Compare each local area in Mkoani to each local area in Mkuranga, identifying where habitats are similar:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert signatures to matrices for pairwise comparison</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>mkoani_mat <span class="ot">=</span> <span class="fu">do.call</span>(rbind, mkoani_cove_local<span class="sc">$</span>signature)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>mkuranga_mat <span class="ot">=</span> <span class="fu">do.call</span>(rbind, mkuranga_cove_local<span class="sc">$</span>signature)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate Jensen-Shannon divergence between all pairs</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Result: rows=Mkoani areas, columns=Mkuranga areas</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>dissimilarity_matrix <span class="ot">=</span> <span class="fu">dist_many_many</span>(</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  mkoani_mat, </span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  mkuranga_mat, </span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"jensen-shannon"</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary of dissimilarities</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">c</span>(dissimilarity_matrix))</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify identical or very similar areas (dissimilarity &lt; 0.05)</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>very_similar <span class="ot">=</span> <span class="fu">which</span>(dissimilarity_matrix <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="at">arr.ind =</span> <span class="cn">TRUE</span>)</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(very_similar)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><strong>Management implication</strong>: Very similar habitat patterns between regions can share management experience; highly dissimilar patterns require custom approaches.</p>
</section>
</section>
<section id="clustering-identifying-ecosystem-types" class="level2">
<h2 class="anchored" data-anchor-id="clustering-identifying-ecosystem-types">Clustering: Identifying Ecosystem Types</h2>
<p>Group local areas with similar habitat patterns into representative ecosystem types:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Partition Around Medoids (PAM) clustering</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="co"># k=6 means 6 ecosystem types across both regions</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>combined_mat <span class="ot">=</span> <span class="fu">rbind</span>(mkoani_mat, mkuranga_mat)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>ecosystem_clusters <span class="ot">=</span> <span class="fu">pam</span>(combined_mat, <span class="at">k =</span> <span class="dv">6</span>)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Add cluster assignments back to spatial data</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>mkoani_cove_local_sf <span class="ot">=</span> <span class="fu">lsp_add_sf</span>(mkoani_cove_local)</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>mkuranga_cove_local_sf <span class="ot">=</span> <span class="fu">lsp_add_sf</span>(mkuranga_cove_local)</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>mkoani_cove_local_sf<span class="sc">$</span>cluster <span class="ot">=</span> ecosystem_clusters<span class="sc">$</span>clustering[<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(mkoani_cove_local_sf)]</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>mkuranga_cove_local_sf<span class="sc">$</span>cluster <span class="ot">=</span> ecosystem_clusters<span class="sc">$</span>clustering[(<span class="fu">nrow</span>(mkoani_cove_local_sf) <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span><span class="fu">nrow</span>(combined_mat)]</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize cluster distribution</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mkoani_cove_local_sf[<span class="st">"cluster"</span>], </span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Mkoani Ecosystem Types"</span>,</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>     <span class="at">pal =</span> <span class="fu">palette.colors</span>(<span class="dv">6</span>))</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mkuranga_cove_local_sf[<span class="st">"cluster"</span>], </span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Mkuranga Ecosystem Types"</span>,</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>     <span class="at">pal =</span> <span class="fu">palette.colors</span>(<span class="dv">6</span>))</span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="interpreting-ecosystem-types" class="level3">
<h3 class="anchored" data-anchor-id="interpreting-ecosystem-types">Interpreting Ecosystem Types</h3>
<p>Visualize the representative area for each cluster:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get medoid (representative) for each cluster</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>ecosystem_types_sf <span class="ot">=</span> combined_mat[ecosystem_clusters<span class="sc">$</span>id.med, ]</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Map to original data to visualize habitat patterns</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_len</span>(<span class="fu">nrow</span>(ecosystem_types_sf))){</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (i <span class="sc">&lt;=</span> <span class="fu">nrow</span>(mkoani_cove_local_sf)){</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>    region_row <span class="ot">=</span> mkoani_cove_local_sf[ecosystem_clusters<span class="sc">$</span>id.med[i], ]</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>    habitat_map <span class="ot">=</span> <span class="fu">crop</span>(habitat_mkoani, region_row)</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>    region_name <span class="ot">=</span> <span class="st">"Mkoani"</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>    region_row <span class="ot">=</span> mkuranga_cove_local_sf[ecosystem_clusters<span class="sc">$</span>id.med[i] <span class="sc">-</span> <span class="fu">nrow</span>(mkoani_cove_local_sf), ]</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>    habitat_map <span class="ot">=</span> <span class="fu">crop</span>(habitat_mkuranga, region_row)</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>    region_name <span class="ot">=</span> <span class="st">"Mkuranga"</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(habitat_map, <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">"Ecosystem Type"</span>, i, <span class="st">"-"</span>, region_name))</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><strong>Interpretation table example</strong>:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Type</th>
<th>Description</th>
<th>Mkoani</th>
<th>Mkuranga</th>
<th>Management</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>Coral-dominated reef</td>
<td>Yes</td>
<td>Yes</td>
<td>Joint conservation priority</td>
</tr>
<tr class="even">
<td>2</td>
<td>Seagrass monoculture</td>
<td>Yes</td>
<td>No</td>
<td>Mkoani-specific monitoring</td>
</tr>
<tr class="odd">
<td>3</td>
<td>Mangrove-coral mosaic</td>
<td>No</td>
<td>Yes</td>
<td>Mkuranga-specific restoration</td>
</tr>
<tr class="even">
<td>4</td>
<td>Sandy plain</td>
<td>Yes</td>
<td>Yes</td>
<td>Shared fishing ground rules</td>
</tr>
<tr class="odd">
<td>5</td>
<td>Complex mixed habitat</td>
<td>Yes</td>
<td>Yes</td>
<td>High biodiversity priority</td>
</tr>
<tr class="even">
<td>6</td>
<td>Degraded/bare areas</td>
<td>No</td>
<td>Yes</td>
<td>Mkuranga restoration focus</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="finding-unique-habitat-patterns" class="level2">
<h2 class="anchored" data-anchor-id="finding-unique-habitat-patterns">Finding Unique Habitat Patterns</h2>
<p>Identify areas with ecosystem patterns unlike any other location—potential priorities for protection or special study:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate minimum dissimilarity between each Mkoani area and any Mkuranga area</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>mkoani_min_dist <span class="ot">=</span> <span class="fu">apply</span>(dissimilarity_matrix, <span class="dv">1</span>, min)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Areas with high minimum distance are unique to Mkoani</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>mkoani_cove_local_sf<span class="sc">$</span>min_dissimilarity <span class="ot">=</span> mkoani_min_dist</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Similarly for Mkuranga</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>mkuranga_min_dist <span class="ot">=</span> <span class="fu">apply</span>(dissimilarity_matrix, <span class="dv">2</span>, min)</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>mkuranga_cove_local_sf<span class="sc">$</span>min_dissimilarity <span class="ot">=</span> mkuranga_min_dist</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize uniqueness</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mkoani_cove_local_sf[<span class="st">"min_dissimilarity"</span>], </span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Mkoani: Habitat Uniqueness</span><span class="sc">\n</span><span class="st">(Brighter = More Unique)"</span>)</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mkuranga_cove_local_sf[<span class="st">"min_dissimilarity"</span>], </span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Mkuranga: Habitat Uniqueness</span><span class="sc">\n</span><span class="st">(Brighter = More Unique)"</span>)</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="identifying-and-protecting-unique-habitats" class="level3">
<h3 class="anchored" data-anchor-id="identifying-and-protecting-unique-habitats">Identifying and Protecting Unique Habitats</h3>
<p>Find the single most unique area in each region—potentially warranting priority conservation:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Most unique area in Mkoani</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>most_unique_mkoani_id <span class="ot">=</span> <span class="fu">which.max</span>(mkoani_cove_local_sf<span class="sc">$</span>min_dissimilarity)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>most_unique_mkoani <span class="ot">=</span> mkoani_cove_local_sf[most_unique_mkoani_id, ]</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Most unique area in Mkuranga</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>most_unique_mkuranga_id <span class="ot">=</span> <span class="fu">which.max</span>(mkuranga_cove_local_sf<span class="sc">$</span>min_dissimilarity)</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>most_unique_mkuranga <span class="ot">=</span> mkuranga_cove_local_sf[most_unique_mkuranga_id, ]</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">crop</span>(habitat_mkoani, most_unique_mkoani), </span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">"Most Unique in Mkoani</span><span class="sc">\n</span><span class="st">(Dissimilarity ="</span>, </span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">round</span>(<span class="fu">max</span>(mkoani_min_dist), <span class="dv">3</span>), <span class="st">")"</span>))</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">crop</span>(habitat_mkuranga, most_unique_mkuranga), </span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">"Most Unique in Mkuranga</span><span class="sc">\n</span><span class="st">(Dissimilarity ="</span>, </span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">round</span>(<span class="fu">max</span>(mkuranga_min_dist), <span class="dv">3</span>), <span class="st">")"</span>))</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><strong>Conservation implication</strong>: Unique habitats may warrant: - Protected area designation - Priority research funding - Monitoring as indicators of ecosystem health - Enhanced stakeholder engagement</p>
</section>
</section>
<section id="multi-scale-analysis" class="level2">
<h2 class="anchored" data-anchor-id="multi-scale-analysis">Multi-Scale Analysis</h2>
<p>Habitat patterns vary with observation scale. Analyze at multiple scales to understand process-specific patterns:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare at three scales</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>scales <span class="ot">=</span> <span class="fu">list</span>(</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">"2.5 km"</span> <span class="ot">=</span> <span class="dv">25</span>,      <span class="co"># 25 cells × 100m</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">"5 km"</span> <span class="ot">=</span> <span class="dv">50</span>,        <span class="co"># 50 cells × 100m</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">"10 km"</span> <span class="ot">=</span> <span class="dv">100</span>       <span class="co"># 100 cells × 100m</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>scale_results <span class="ot">=</span> <span class="fu">list</span>()</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (scale_name <span class="cf">in</span> <span class="fu">names</span>(scales)){</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>  window_size <span class="ot">=</span> scales[[scale_name]]</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate signatures at this scale</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>  mkoani_sig <span class="ot">=</span> <span class="fu">lsp_signature</span>(habitat_mkoani, </span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>                             <span class="at">type =</span> <span class="st">"cove"</span>,</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>                             <span class="at">window =</span> window_size, </span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>                             <span class="at">classes =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>)</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>  mkuranga_sig <span class="ot">=</span> <span class="fu">lsp_signature</span>(habitat_mkuranga, </span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>                               <span class="at">type =</span> <span class="st">"cove"</span>,</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>                               <span class="at">window =</span> window_size, </span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>                               <span class="at">classes =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>)</span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Compare</span></span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>  mkoani_m <span class="ot">=</span> <span class="fu">do.call</span>(rbind, mkoani_sig<span class="sc">$</span>signature)</span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>  mkuranga_m <span class="ot">=</span> <span class="fu">do.call</span>(rbind, mkuranga_sig<span class="sc">$</span>signature)</span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>  diss <span class="ot">=</span> <span class="fu">dist_many_many</span>(mkoani_m, mkuranga_m, <span class="at">method =</span> <span class="st">"jensen-shannon"</span>)</span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a>  scale_results[[scale_name]] <span class="ot">=</span> <span class="fu">list</span>(</span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_mkoani_areas =</span> <span class="fu">nrow</span>(mkoani_m),</span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_mkuranga_areas =</span> <span class="fu">nrow</span>(mkuranga_m),</span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_dissimilarity =</span> <span class="fu">mean</span>(diss),</span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">range_dissimilarity =</span> <span class="fu">range</span>(diss)</span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Display results</span></span>
<span id="cb11-38"><a href="#cb11-38" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (scale_name <span class="cf">in</span> <span class="fu">names</span>(scale_results)){</span>
<span id="cb11-39"><a href="#cb11-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(scale_name, <span class="st">"scale:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb11-40"><a href="#cb11-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"  Mean dissimilarity:"</span>, </span>
<span id="cb11-41"><a href="#cb11-41" aria-hidden="true" tabindex="-1"></a>      <span class="fu">round</span>(scale_results[[scale_name]]<span class="sc">$</span>mean_dissimilarity, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb11-42"><a href="#cb11-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"  Range:"</span>, </span>
<span id="cb11-43"><a href="#cb11-43" aria-hidden="true" tabindex="-1"></a>      <span class="fu">round</span>(scale_results[[scale_name]]<span class="sc">$</span>range_dissimilarity[<span class="dv">1</span>], <span class="dv">3</span>), <span class="st">"-"</span>,</span>
<span id="cb11-44"><a href="#cb11-44" aria-hidden="true" tabindex="-1"></a>      <span class="fu">round</span>(scale_results[[scale_name]]<span class="sc">$</span>range_dissimilarity[<span class="dv">2</span>], <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb11-45"><a href="#cb11-45" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><strong>Interpretation</strong>: If mean dissimilarity increases at coarser scales, Mkoani and Mkuranga have local similarity but regional differences (suggesting local adaptation vs regional context).</p>
</section>
<section id="integration-with-msp" class="level2">
<h2 class="anchored" data-anchor-id="integration-with-msp">Integration with MSP</h2>
<section id="key-outputs-for-marine-spatial-planning" class="level3">
<h3 class="anchored" data-anchor-id="key-outputs-for-marine-spatial-planning">Key Outputs for Marine Spatial Planning</h3>
<ol type="1">
<li><strong>Ecosystem Type Map</strong>: Spatial distribution of 6 ecosystem types provides basis for:
<ul>
<li>Zoning different use types (fishing, conservation, restoration)</li>
<li>Targeting management interventions</li>
<li>Monitoring priority locations</li>
</ul></li>
<li><strong>Uniqueness Map</strong>: Identifies:
<ul>
<li>Priority conservation areas (most unique)</li>
<li>Representative areas for indicator monitoring</li>
<li>Research sites for process understanding</li>
</ul></li>
<li><strong>Cross-Regional Comparison</strong>: Understanding pattern similarity enables:
<ul>
<li>Shared management learning (similar areas share strategies)</li>
<li>Region-specific adaptation (unique areas need custom approaches)</li>
<li>Coordinated conservation planning</li>
</ul></li>
</ol>
</section>
<section id="implementation-timeline" class="level3">
<h3 class="anchored" data-anchor-id="implementation-timeline">Implementation Timeline</h3>
<p><strong>January 2026</strong>: Ground-truth ecosystem classifications - Field surveys at representative sites from each cluster - Refine habitat boundaries based on underwater video/visual surveys - Validate in-water habitat extent</p>
<p><strong>February 2026</strong>: Spatial pattern analysis and stakeholder mapping - Complete clustering and uniqueness analysis - Prepare maps for stakeholder validation meetings - Identify consensus priorities from ecosystem types</p>
<p><strong>March 2026</strong>: Zoning development - Use ecosystem types and uniqueness to inform zone design - Integrate with economic analysis (fishing grounds, tourism) - Develop management prescriptions per ecosystem type</p>
<p><strong>April 2026</strong>: Monitoring protocol design - Select representative areas from each ecosystem type for ongoing monitoring - Design indicator species/community sampling for unique areas - Integrate into long-term MSP adaptive management plan</p>
</section>
</section>
<section id="references" class="level2">
<h2 class="anchored" data-anchor-id="references">References</h2>
<p>Nowosad, Jakub. 2023. “Finding the Most Unique Land Cover Spatial Pattern.” <em>Thinking in Spatial Patterns</em> (blog), December 3, 2023. https://jakubnowosad.com/posts/2023-12-03-motif-bp8/</p>
<p>Nowosad, Jakub, and Tomasz F. Stepinski. 2022. “Motif: An Open-Source R Tool for Identifying and Comparing Spatial Patterns of Land-Use/Land-Cover and Landscape Metrics.” <em>Landscape Ecology</em>, 37(9): 2899-2915.</p>
<p>Kaufman, Leonard, and Peter J. Rousseeuw. 1990. <em>Finding Groups in Data: An Introduction to Cluster Analysis</em>. John Wiley &amp; Sons.</p>
<p>Wang, Zhaoqian, et al.&nbsp;2024. “Spatial Pattern Recognition in Marine Ecosystems.” <em>Marine Ecology Progress Series</em> (in press).</p>
<p>Semba, Masumbuko, Siajali Pamba, and collaborators. 2025. “Marine Spatial Planning Initiative: Mkoani-Pemba and Mkuranga, Pwani Region, Tanzania.” NM-AIST Technical Report.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
<p>© 2025 Semba | Marine Spatial Planning | Led by <a href="https://www.udsm.ac.tz">SOAF-UDSM</a> | <a href="mailto:msp.coastal.tz@udsm.ac.tz">Contact Us</a></p>
</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>